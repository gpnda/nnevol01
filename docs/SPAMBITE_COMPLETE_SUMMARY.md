# SpambiteExperiment: –ü–æ–ª–Ω–æ–µ —Ä–µ–∑—é–º–µ –≤—Å–µ—Ö 7 —ç—Ç–∞–ø–æ–≤ ‚úì –ó–ê–í–ï–†–®–ï–ù–û

## –û–±–∑–æ—Ä

**SpambiteExperiment** - —ç—Ç–æ –ø–æ–ª–Ω–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ–≤–µ–¥–µ–Ω–∏—è —Å—É—â–µ—Å—Ç–≤ –Ω–∞ –ø–æ–∏—Å–∫ –ø–∏—â–∏ –≤ –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Å—Ä–µ–¥–µ. –°–∏—Å—Ç–µ–º–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã DTO –¥–ª—è –ø–æ–ª–Ω–æ–π –∏–∑–æ–ª—è—Ü–∏–∏ –æ—Ç –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –º–∏—Ä–∞.

**–°—Ç–∞—Ç—É—Å**: ‚úÖ –ì–û–¢–û–í–û –ö –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–Æ

---

## –≠—Ç–∞–ø 1: DTO Infrastructure ‚úÖ

### –ß—Ç–æ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ
–†–∞—Å—à–∏—Ä–µ–Ω–∞ —Å–∏—Å—Ç–µ–º–∞ DTO –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤:

1. **RenderStateDTO** (renderer/v3dto/dto.py)
   - –î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–ª–µ: `experiment_dto: Optional[object] = None`
   - –ü–æ–∑–≤–æ–ª—è–µ—Ç –ª—é–±–æ–º—É —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—É –ø–µ—Ä–µ–¥–∞—Ç—å —Å–≤–æ–π DTO

2. **ExperimentBase** (experiments/base/experiment_base.py)
   - –î–æ–±–∞–≤–ª–µ–Ω –∞–±—Å—Ç—Ä–∞–∫—Ç–Ω—ã–π –º–µ—Ç–æ–¥: `get_dto() -> object`
   - –í—Å–µ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã –¥–æ–ª–∂–Ω—ã —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —ç—Ç–æ—Ç –º–µ—Ç–æ–¥

### –†–µ–∑—É–ª—å—Ç–∞—Ç
–ü–æ–ª–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ DTO-based –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –¥–ª—è —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤.

---

## –≠—Ç–∞–ø 2: Project Structure ‚úÖ

### –ß—Ç–æ –±—ã–ª–æ —Å–æ–∑–¥–∞–Ω–æ

```
experiments/spambite/
‚îú‚îÄ‚îÄ __init__.py           # –≠–∫—Å–ø–æ—Ä—Ç—ã
‚îú‚îÄ‚îÄ experiment.py         # 417 —Å—Ç—Ä–æ–∫ - –æ—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞
‚îú‚îÄ‚îÄ widget.py            # 323 —Å—Ç—Ä–æ–∫–∏ - –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è
‚îî‚îÄ‚îÄ dto.py              # 57 —Å—Ç—Ä–æ–∫ - DTO –¥–ª—è –¥–∞–Ω–Ω—ã—Ö
```

### –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
- experiments/__init__.py –æ–±–Ω–æ–≤–ª–µ–Ω
- SpambiteExperiment –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω –≤ EXPERIMENTS registry
- –î–æ—Å—Ç—É–ø–µ–Ω —á–µ—Ä–µ–∑ –≤—ã–±–æ—Ä –≤ —Å–ø–∏—Å–∫–µ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤ (F2)

### –†–µ–∑—É–ª—å—Ç–∞—Ç
–ü–æ–ª–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞, –≥–æ—Ç–æ–≤–∞—è –¥–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –ª–æ–≥–∏–∫–∏.

---

## –≠—Ç–∞–ø 3: Implement start() ‚úÖ

### –ß—Ç–æ –±—ã–ª–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

**SpambiteExperiment.start()** - 39 —Å—Ç—Ä–æ–∫ –∫–æ–¥–∞

```python
def start(self) -> None:
    """–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç."""
    print(f"[EXPERIMENT] Starting SpambiteExperiment on creature {self.creature_id}")
    
    # 1. –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤–æ–µ —Å—É—â–µ—Å—Ç–≤–æ –∏–∑ DTO
    self._create_creature_from_dto()
    
    # 2. –°–æ–∑–¥–∞—Ç—å –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –º–∏—Ä 50x50
    self._create_temp_world()
    
    # 3. –°–ø–∞–≤–Ω–∏—Ç—å –ø–µ—Ä–≤—É—é –ø–∏—â—É
    self._spawn_food()
    
    # 4. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å—á–µ—Ç—á–∏–∫–∏
    self.current_iteration = 1
    self.successes = 0
    self.failures = 0
    self.frames_in_iteration = 0
```

**–ö–ª—é—á–µ–≤—ã–µ –º–æ–º–µ–Ω—Ç—ã**:
- Creature –∫–æ–ø–∏—Ä—É–µ—Ç—Å—è –∏–∑ DTO, –∑–∞—Ç–µ–º –≤–æ—Å—Å–æ–∑–¥–∞–µ—Ç—Å—è (–ù–ï –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è reference –Ω–∞ –æ—Ä–∏–≥–∏–Ω–∞–ª)
- WorldGenerator —Å–æ–∑–¥–∞–µ—Ç 50x50 –º–∏—Ä —Å —Å—Ç–µ–Ω–∞–º–∏
- –°—É—â–µ—Å—Ç–≤–æ —Å–ø–∞–≤–Ω–∏—Ç—Å—è –≤ —Ü–µ–Ω—Ç—Ä–µ (25, 25) —Å energy=1000
- –ü–∏—â–∞ —Å–ø–∞–≤–Ω–∏—Ç—Å—è –≤ —Å–ª—É—á–∞–π–Ω–æ–º –º–µ—Å—Ç–µ

### –†–µ–∑—É–ª—å—Ç–∞—Ç
–ì–æ—Ç–æ–≤–∞—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–ª—è –ø–µ—Ä–≤–æ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞.

---

## –≠—Ç–∞–ø 4: Implement update() ‚úÖ

### –ß—Ç–æ –±—ã–ª–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

**SpambiteExperiment.update()** - 78 —Å—Ç—Ä–æ–∫ –∫–æ–¥–∞

```python
def update(self) -> None:
    """–ó–∞–ø—É—Å—Ç–∏—Ç—å –æ–¥–∏–Ω —Ñ—Ä–µ–π–º —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞."""
    
    if not self.experiment_mode or self.iteration_complete:
        return
    
    # 1. –°–∏–º—É–ª–∏—Ä–æ–≤–∞—Ç—å –æ–¥–∏–Ω —Ç–∏–∫ –º–∏—Ä–∞
    self.temp_world.update()
    
    # 2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —É—Å–ø–µ—Ö (–ø–∏—â–∞ —Å—ä–µ–¥–µ–Ω–∞)
    if len(self.temp_world.foods) == 0:
        self.successes += 1
        self._log_result("SUCCESS - Food eaten!")
        self._prepare_next_iteration()
        return
    
    # 3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–µ—É–¥–∞—á—É (—Å—É—â–µ—Å—Ç–≤–æ –ø–æ—Ç–µ—Ä—è–ª–æ –ø–∏—â—É –∏–∑ –≤–∏–¥—É)
    if self._is_creature_far_from_food():
        self.failures += 1
        self._log_result("FAILURE - Creature moved too far")
        self._prepare_next_iteration()
        return
    
    # 4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å timeout (300 —Ñ—Ä–µ–π–º–æ–≤ –±–µ–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞)
    if self.frames_in_iteration >= self.MAX_FRAMES_PER_ITERATION:
        self.failures += 1
        self._log_result("FAILURE - Timeout reached")
        self._prepare_next_iteration()
        return
    
    # 5. –û–±–Ω–æ–≤–∏—Ç—å —Å—á–µ—Ç—á–∏–∫ —Ñ—Ä–µ–π–º–æ–≤
    self.frames_in_iteration += 1
    
    # 6. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ –≤—Å–µ—Ö –∏—Ç–µ—Ä–∞—Ü–∏–π
    if self.current_iteration > self.MAX_ITERATIONS:
        self.stop()
```

**–õ–æ–≥–∏–∫–∞ —É—Å–ø–µ—Ö–∞/–Ω–µ—É–¥–∞—á–∏**:
1. **SUCCESS** - –°—É—â–µ—Å—Ç–≤–æ —É–∫—É—Å–∏–ª–æ –ø–∏—â—É (foods == 0)
2. **FAILURE (far)** - –°—É—â–µ—Å—Ç–≤–æ –æ—Ç–æ—à–ª–æ –±–æ–ª–µ–µ —á–µ–º –Ω–∞ 20 –∫–ª–µ—Ç–æ–∫ –æ—Ç –ø–∏—â–∏
3. **FAILURE (timeout)** - 300 —Ñ—Ä–µ–π–º–æ–≤ –±–µ–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞

### –†–µ–∑—É–ª—å—Ç–∞—Ç
–ü–æ–ª–Ω–æ—Ü–µ–Ω–Ω–∞—è —Å–∏–º—É–ª—è—Ü–∏—è 20 –∏—Ç–µ—Ä–∞—Ü–∏–π —Å –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤.

---

## –≠—Ç–∞–ø 5: Implement stop() ‚úÖ

### –ß—Ç–æ –±—ã–ª–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

**SpambiteExperiment.stop()** - 31 —Å—Ç—Ä–æ–∫–∞ –∫–æ–¥–∞

```python
def stop(self) -> None:
    """–ó–∞–≤–µ—Ä—à–∏—Ç—å —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç –∏ –≤—ã–≤–µ—Å—Ç–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã."""
    
    self.experiment_mode = False
    
    # 1. –í—ã–≤–µ—Å—Ç–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ –∫–æ–Ω—Å–æ–ª—å
    self._print_results()
    
    # 2. –û—á–∏—Å—Ç–∏—Ç—å –ø–∞–º—è—Ç—å
    self.temp_world = None
    self.creature = None
    self.current_food = None
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–µ—á–∞—Ç–∞—é—Ç—Å—è –≤ —Ñ–æ—Ä–º–∞—Ç–µ**:
```
[EXPERIMENT] ============ SpambiteExperiment Results ============
[EXPERIMENT] Total Iterations: 20
[EXPERIMENT] Successes: X
[EXPERIMENT] Failures: Y
[EXPERIMENT] Success Rate: Z%
[EXPERIMENT] 
[EXPERIMENT] Interpretation: [EXCELLENT/GOOD/MODERATE/POOR/VERY POOR]
[EXPERIMENT] ===================================================
```

**–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è**:
- 80-100% ‚Üí EXCELLENT
- 60-80% ‚Üí GOOD
- 40-60% ‚Üí MODERATE
- 20-40% ‚Üí POOR
- 0-20% ‚Üí VERY POOR

### –†–µ–∑—É–ª—å—Ç–∞—Ç
–ö—Ä–∞—Å–∏–≤—ã–π –≤—ã–≤–æ–¥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ —Å –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–µ–π –∫–∞—á–µ—Å—Ç–≤–∞.

---

## –≠—Ç–∞–ø 6: Widget Visualization ‚úÖ

### –ß—Ç–æ –±—ã–ª–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

**SpambiteExperimentWidget** - 323 —Å—Ç—Ä–æ–∫–∏ –∫–æ–¥–∞

```
‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
‚ïë                   SpambiteExperiment                         ‚ïë
‚ï†‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ï£
‚ïë                                                              ‚ïë
‚ïë  ‚îå‚îÄ‚îÄ‚îÄ Map (50x50) ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ Stats ‚îÄ‚îÄ‚îÄ‚îê    ‚ïë
‚ïë  ‚îÇ ‚îå‚îê‚îê‚îê‚îê‚îê‚îê‚îê‚îê‚îê‚îê‚îê‚îê‚îê‚îê‚îê‚îê‚îê‚îê‚îê‚îê‚îê‚îê‚îê‚îê‚îê‚îê‚îê‚îê‚îê‚îê‚îê‚îê ‚îÇ  ‚îÇIteration  ‚îÇ    ‚ïë
‚ïë  ‚îÇ ‚îå    [R]                    . ‚îê‚îê‚îê‚îê ‚îÇ  ‚îÇ  1/20     ‚îÇ    ‚ïë
‚ïë  ‚îÇ ‚îå                           ‚îê‚îê‚îê‚îê‚îê‚îê ‚îÇ  ‚îÇ           ‚îÇ    ‚ïë
‚ïë  ‚îÇ ‚îå                           ‚îê‚îê‚îê‚îê‚îê‚îê ‚îÇ  ‚îÇSuccesses  ‚îÇ    ‚ïë
‚ïë  ‚îÇ ‚îå                           ‚îê‚îê‚îê‚îê‚îê‚îê ‚îÇ  ‚îÇ  5        ‚îÇ    ‚ïë
‚ïë  ‚îÇ ‚îå                           ‚îê‚îê‚îê‚îê‚îê‚îê ‚îÇ  ‚îÇ           ‚îÇ    ‚ïë
‚ïë  ‚îÇ ‚îå‚îê‚îê‚îê‚îê‚îê‚îê‚îê‚îê‚îê‚îê‚îê‚îê‚îê‚îê‚îê‚îê‚îê‚îê‚îê‚îê‚îê‚îê‚îê‚îê‚îê‚îê‚îê‚îê‚îê‚îê‚îê‚îê ‚îÇ  ‚îÇFailures   ‚îÇ    ‚ïë
‚ïë  ‚îÇ                                     ‚îÇ  ‚îÇ  15       ‚îÇ    ‚ïë
‚ïë  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ           ‚îÇ    ‚ïë
‚ïë                                           ‚îÇRate: 25% ‚îÇ    ‚ïë
‚ïë                                           ‚îÇ[======  ]‚îÇ    ‚ïë
‚ïë                                           ‚îÇFrames:15/‚îÇ    ‚ïë
‚ïë                                           ‚îÇ          ‚îÇ    ‚ïë
‚ïë                                           ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚ïë
‚ïë                                                              ‚ïë
‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù
```

**–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã**:
1. **Map Rendering** (8x8 –ø–∏–∫—Å–µ–ª–∏ –Ω–∞ –∫–ª–µ—Ç–∫—É = 400x400)
   - –°—Ç–µ–Ω—ã (—Ç–µ–º–Ω–æ-—Å–∏–Ω–∏–µ)
   - –°—É—â–µ—Å—Ç–≤–æ (–∫—Ä–∞—Å–Ω–∞—è —Ç–æ—á–∫–∞)
   - –ü–∏—â–∞ (–∑–µ–ª–µ–Ω–∞—è —Ç–æ—á–∫–∞)

2. **Statistics Panel**
   - Current iteration (1-20)
   - Successes count
   - Failures count
   - Success rate percentage
   - Progress bar for frames (0-300)

**–¶–≤–µ—Ç–æ–≤–∞—è —Å—Ö–µ–º–∞**:
- Background: RGB(20, 20, 20) - —á–µ—Ä–Ω—ã–π
- Text: RGB(200, 200, 200) - —Å–µ—Ä—ã–π
- Creature: RGB(255, 0, 0) - –∫—Ä–∞—Å–Ω—ã–π
- Food: RGB(0, 255, 0) - –∑–µ–ª–µ–Ω—ã–π
- Wall: RGB(50, 50, 100) - —Ç–µ–º–Ω–æ-—Å–∏–Ω–∏–π

### –†–µ–∑—É–ª—å—Ç–∞—Ç
–ü–æ–ª–Ω–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –≤–∏–¥–∂–µ—Ç —Å —Ä–µ–∞–ª-—Ç–∞–π–º –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–µ–π –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π.

---

## –≠—Ç–∞–ø 7: Renderer Integration ‚úÖ

### –ß—Ç–æ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ

**renderer/v3dto/renderer.py** (lines 450-473)

–û–±–Ω–æ–≤–ª–µ–Ω –º–µ—Ç–æ–¥ `_prepare_render_state_dto()`:

```python
def _prepare_render_state_dto(self) -> RenderStateDTO:
    """..."""
    # ... —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∫–æ–¥ ...
    
    # –ü–æ–ª—É—á–∞–µ–º experiment_dto –µ—Å–ª–∏ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç –∞–∫—Ç–∏–≤–µ–Ω
    experiment_dto = None
    if hasattr(self.app, 'experiment') and self.app.experiment is not None:
        if hasattr(self.app.experiment, 'get_dto'):
            experiment_dto = self.app.experiment.get_dto()
    
    return RenderStateDTO(
        # ... –¥—Ä—É–≥–∏–µ –ø–æ–ª—è ...
        experiment_dto=experiment_dto,  # ‚Üê –ù–û–í–û–ï
        # ... –¥—Ä—É–≥–∏–µ –ø–æ–ª—è ...
    )
```

**–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞**:
1. Renderer.draw() –≤—ã–∑—ã–≤–∞–µ—Ç _prepare_render_state_dto()
2. _prepare_render_state_dto() –ø–æ–ª—É—á–∞–µ—Ç experiment.get_dto()
3. RenderStateDTO –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –≤ –≤–∏–¥–∂–µ—Ç—ã
4. Renderer._draw_experiment() –≤—ã–∑—ã–≤–∞–µ—Ç experiment_widget.draw(screen, render_state)

**–†–µ–∑—É–ª—å—Ç–∞—Ç**:
–ü–æ–ª–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã, –≥–æ—Ç–æ–≤–∞—è –∫ —Ä–∞–±–æ—Ç–µ.

---

## –û–±—â–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### Data Flow

```
Main Simulation              SpambiteExperiment          Renderer
    ‚Üì                             ‚Üì                           ‚Üì
world.creatures ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚Üí target_creature_dto ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚Üí experiment
world.foods                                                    ‚Üì
                                                       _prepare_render_state_dto()
                                                                ‚Üì
                                                       experiment.get_dto()
                                                                ‚Üì
                                                       SpambiteExperimentDTO
                                                                ‚Üì
                                                       RenderStateDTO
                                                                ‚Üì
                                                       experiment_widget.draw()
                                                                ‚Üì
                                                       pygame.Surface
                                                                ‚Üì
                                                           Display
```

### Key Components

| File | Lines | Purpose |
|------|-------|---------|
| experiment.py | 417 | Core logic - 20 iterations, success/failure tracking |
| widget.py | 323 | Visualization - 50x50 map + statistics |
| dto.py | 57 | Data transfer object |
| renderer.py | 800 | Integration with main rendering system |
| application.py | 203 | Initialization and experiment lifecycle |

### Design Patterns

1. **DTO Pattern**: Complete isolation from main world
2. **Registry Pattern**: Centralized EXPERIMENTS management
3. **Strategy Pattern**: Different experiment types via registry
4. **Factory Pattern**: Widget creation from registry
5. **Callback Pattern**: Modal ‚Üí Renderer ‚Üí Application
6. **State Machine**: Mode transitions (main ‚Üí experiment ‚Üí main)

---

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

1. –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:
   ```bash
   python nnevol.py
   ```

2. –í—ã–±—Ä–∞—Ç—å —Å—É—â–µ—Å—Ç–≤–æ (F1 –∏–ª–∏ TAB)

3. –ó–∞–ø—É—Å—Ç–∏—Ç—å SpambiteExperiment (F2 ‚Üí –≤—ã–±—Ä–∞—Ç—å 1 ‚Üí Enter)

4. –ù–∞–±–ª—é–¥–∞—Ç—å 20 –∏—Ç–µ—Ä–∞—Ü–∏–π —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

5. ESC –¥–ª—è –≤—ã—Ö–æ–¥–∞

### –ß—Ç–æ –ø—Ä–æ–≤–µ—Ä—è—Ç—å

- [ ] Widget –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è —Å –∫–∞—Ä—Ç–æ–π 50x50
- [ ] –°—É—â–µ—Å—Ç–≤–æ (–∫—Ä–∞—Å–Ω–æ–µ) –≤–∏–¥–Ω–æ –≤ —Ü–µ–Ω—Ç—Ä–µ
- [ ] –ü–∏—â–∞ (–∑–µ–ª–µ–Ω–∞—è) –≤–∏–¥–Ω–∞ –Ω–∞ –∫–∞—Ä—Ç–µ
- [ ] –°—É—â–µ—Å—Ç–≤–æ –¥–≤–∏–∂–µ—Ç—Å—è –∫ –ø–∏—â–µ
- [ ] –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –∫–∞–∂–¥—ã–π —Ñ—Ä–µ–π–º
- [ ] –ü–æ—Å–ª–µ –Ω–∞–π–¥–µ–Ω–Ω–æ–π –ø–∏—â–∏ ‚Üí –Ω–æ–≤–∞—è –∏—Ç–µ—Ä–∞—Ü–∏—è
- [ ] –ü–æ—Å–ª–µ 20 –∏—Ç–µ—Ä–∞—Ü–∏–π ‚Üí –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏
- [ ] ESC –∑–∞–∫—Ä—ã–≤–∞–µ—Ç —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç

–î–µ—Ç–∞–ª—å–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ: [TESTING_SPAMBITE_EXPERIMENT.md](TESTING_SPAMBITE_EXPERIMENT.md)

---

## –§–∞–π–ª—ã, —Å–æ–∑–¥–∞–Ω–Ω—ã–µ/–∏–∑–º–µ–Ω–µ–Ω–Ω—ã–µ

### –°–æ–∑–¥–∞–Ω—ã (–Ω–æ–≤—ã–µ —Ñ–∞–π–ª—ã)

1. **experiments/spambite/experiment.py** - 417 —Å—Ç—Ä–æ–∫
2. **experiments/spambite/widget.py** - 323 —Å—Ç—Ä–æ–∫–∏
3. **experiments/spambite/dto.py** - 57 —Å—Ç—Ä–æ–∫
4. **experiments/spambite/__init__.py** - 18 —Å—Ç—Ä–æ–∫
5. **docs/ETAP7_RENDERER_INTEGRATION.md** - –Ω–æ–≤—ã–π –¥–æ–∫—É–º–µ–Ω—Ç
6. **docs/TESTING_SPAMBITE_EXPERIMENT.md** - –Ω–æ–≤—ã–π –¥–æ–∫—É–º–µ–Ω—Ç

### –ò–∑–º–µ–Ω–µ–Ω—ã (–º–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω—ã)

1. **renderer/v3dto/dto.py**
   - –î–æ–±–∞–≤–ª–µ–Ω–æ: `experiment_dto: Optional[object] = None` –≤ RenderStateDTO

2. **experiments/base/experiment_base.py**
   - –î–æ–±–∞–≤–ª–µ–Ω–æ: –∞–±—Å—Ç—Ä–∞–∫—Ç–Ω—ã–π –º–µ—Ç–æ–¥ `get_dto() -> object`

3. **experiments/__init__.py**
   - –î–æ–±–∞–≤–ª–µ–Ω—ã –∏–º–ø–æ—Ä—Ç—ã SpambiteExperiment –∏ SpambiteExperimentWidget
   - –î–æ–±–∞–≤–ª–µ–Ω —Ä–µ–≥–∏—Å—Ç—Ä EXPERIMENTS['spambite']

4. **application.py**
   - –î–æ–±–∞–≤–ª–µ–Ω–æ: `experiment_mode`, `experiment` –∞—Ç—Ä–∏–±—É—Ç—ã
   - –î–æ–±–∞–≤–ª–µ–Ω–æ: `init_experiment()` –º–µ—Ç–æ–¥
   - –î–æ–±–∞–≤–ª–µ–Ω–æ: –≤—ã–∑–æ–≤ `experiment.update()` –≤ —Ü–∏–∫–ª–µ

5. **renderer/v3dto/renderer.py** (–≠—Ç–∞–ø 7)
   - –û–±–Ω–æ–≤–ª–µ–Ω–æ: `_prepare_render_state_dto()` - –¥–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–ª—É—á–µ–Ω–∏–µ experiment_dto

### –í—Å–µ–≥–æ —Å—Ç—Ä–æ–∫ –∫–æ–¥–∞

- **–ù–æ–≤—ã—Ö**: ~817 —Å—Ç—Ä–æ–∫ (experiment.py + widget.py + dto.py)
- **–ò–∑–º–µ–Ω–µ–Ω–æ**: ~50 —Å—Ç—Ä–æ–∫ (–≤ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —Ñ–∞–π–ª–∞—Ö)
- **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**: ~400 —Å—Ç—Ä–æ–∫

---

## –î–∞–ª—å–Ω–µ–π—à–∏–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### Short term (1-2 –Ω–µ–¥–µ–ª–∏)
- [ ] –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –æ—Ç–ª–∞–¥–∫–∞
- [ ] –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- [ ] –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

### Medium term (1 –º–µ—Å—è—Ü)
- [ ] –°–æ–∑–¥–∞–Ω–∏–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤:
  - Nutrition analysis (–∞–Ω–∞–ª–∏–∑ –ø–∏—Ç–∞–Ω–∏—è)
  - Neural activity profiler (–ø—Ä–æ—Ñ–∞–π–ª–µ—Ä –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –Ω–µ–π—Ä–æ—Å–µ—Ç–∏)
  - Predator avoidance (–∏–∑–±–µ–≥–∞–Ω–∏–µ —Ö–∏—â–Ω–∏–∫–æ–≤)
- [ ] –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≤ —Ñ–∞–π–ª
- [ ] GUI –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –∏—Å—Ç–æ—Ä–∏–∏ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤

### Long term (3+ –º–µ—Å—è—Ü–∞)
- [ ] –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã –Ω–∞ —Ä–∞–∑–Ω—ã—Ö —Å—É—â–µ—Å—Ç–≤–∞—Ö
- [ ] ML –∞–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
- [ ] –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ —Ä–∞–∑–Ω—ã—Ö –æ—Å–æ–±–µ–π
- [ ] –≠–≤–æ–ª—é—Ü–∏–æ–Ω–Ω—ã–µ —Ä–µ–π—Ç–∏–Ω–≥–∏

---

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

‚úÖ **–í—Å–µ 7 —ç—Ç–∞–ø–æ–≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ SpambiteExperiment –∑–∞–≤–µ—Ä—à–µ–Ω—ã**

–°–∏—Å—Ç–µ–º–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞, —Ö–æ—Ä–æ—à–æ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–∞ –∏ –≥–æ—Ç–æ–≤–∞ –∫:
1. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é
2. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –≤ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è—Ö –ø–æ–≤–µ–¥–µ–Ω–∏—è —Å—É—â–µ—Å—Ç–≤
3. –†–∞—Å—à–∏—Ä–µ–Ω–∏—é –Ω–æ–≤—ã–º–∏ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–º–∏

**–ö–ª—é—á–µ–≤—ã–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è**:
- ‚úì –ü–æ–ª–Ω–∞—è –∏–∑–æ–ª—è—Ü–∏—è –æ—Ç –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –º–∏—Ä–∞ —á–µ—Ä–µ–∑ DTO
- ‚úì –ß–∏—Å—Ç–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –±–µ–∑ —Ü–∏–∫–ª–∏—á–µ—Å–∫–∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
- ‚úì –õ–µ–≥–∫–æ —Ä–∞—Å—à–∏—Ä—è–µ–º–∞—è —Å–∏—Å—Ç–µ–º–∞ (–Ω–æ–≤—ã–µ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è —á–µ—Ä–µ–∑ registry)
- ‚úì –ü–æ–ª–Ω–∞—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Å —Ä–µ–∞–ª-—Ç–∞–π–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ–º
- ‚úì –ò–Ω—Ç—É–∏—Ç–∏–≤–Ω—ã–π UI —á–µ—Ä–µ–∑ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π Renderer

**–°—Ç–∞—Ç—É—Å**: üü¢ –ì–û–¢–û–í–û –ö –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–Æ

---

*–î–æ–∫—É–º–µ–Ω—Ç —Å–æ–∑–¥–∞–Ω: 2025 –≥–æ–¥*
*–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ: –≠—Ç–∞–ø 7 - Renderer Integration*
